{% extends "base.html" %}
{% from "_formhelpers.html" import field_error %}

{% block content %}
<div class="row">
    <div class="col-md-6">
        <div class="page-header">
            <h1>Create a poll</h1>
        </div>
        <form class="form" method="POST">
            {{ form.hidden_tag() }}
            {{ field_error(form.hidden_tag) }}

            <div class="form-group">
                {{ form.title.label }}
                {{ form.title(class="form-control", **{'data-slug-field':"#slug"}) }}
                {{ field_error(form.title) }}
            </div>
            <div class="form-group">
                {{ form.slug.label }}
                <div class="input-group">
                    <span class="input-group-addon">{{ url_for('poll', slug='', _external=True) }}</span>
                    {{ form.slug(class="form-control") }}
                </div>
                {{ field_error(form.slug) }}
                <noscript><span class="help-block">This would be automatically
                    generated for you if you moron had not blocked javascript.</span></noscript>
            </div>
            <div class="form-group">
                {{ form.type.label }}
                {{ form.type(class="form-control") }}
                {{ field_error(form.type) }}
            </div>
            <div class="form-group">
                {{ form.due_date.label }} <span class="help-inline">optional</span>
                {{ form.due_date(class="form-control") }}
                {{ field_error(form.due_date) }}
            </div>
            <div class="form-group">
                <input type="submit" value="Create" class="btn btn-primary"/>
            </div>
        </form>
    </div>

    <div class="col-md-6">
        <div class="page-header">
            <h1>Recent polls</h1>
        </div>
        <ul>
            {% for poll in polls %}
                <li>
                    <a href="{{ poll.get_url() }}">{{ poll.title }}</a>
                </li>
            {% endfor %}
        </ul>

        {% if not polls %}
        <p class="alert alert-info">
            There are currently no public polls.
        </p>
        {% endif %}

        <hr />
        <h2>Dudel statistics</h2>
        <table class="table auto-width">
            <tr><th>Polls created</th><td>{{ poll_count }}</td></tr>
            <tr><th>Votes cast</th><td>{{ vote_count }}</td></tr>
            <tr><th>Users</th><td>{{ user_count }}</td></tr>
        </table>
    </div>
</div>
{% endblock %}
